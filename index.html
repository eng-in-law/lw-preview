<!DOCTYPE html>
<html lang="ko" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>입법예고 대시보드 Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/fuse.js/dist/fuse.basic.min.js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        gray: { 750: '#2d2d2d', 850: '#1a1a1a', 900: '#121212', 950: '#0a0a0a' },
                        purple: { 500: '#8b5cf6', 600: '#7c3aed' }
                    },
                    // 모바일 브라우저 높이 대응
                    height: { 'screen-dvh': '100dvh' } 
                }
            }
        }
    </script>
    <style>
        /* 스크롤바 커스텀 */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #121212; }
        ::-webkit-scrollbar-thumb { background: #374151; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #4b5563; }
        
        /* 모바일에서 텍스트 선택 방지 (앱 같은 느낌) */
        .no-select { user-select: none; -webkit-user-select: none; }
        
        /* 슬라이드 애니메이션 */
        .slide-panel { transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1); }
    </style>
</head>
<body class="bg-[#121212] text-gray-100 font-sans antialiased overflow-hidden h-screen-dvh selection:bg-purple-500 selection:text-white"
      x-data="app()"
      x-init="initApp()">

    <div class="flex h-full w-full relative">

        <div x-show="isNavOpen || window.innerWidth >= 768" 
             class="fixed md:static inset-y-0 left-0 z-40 w-64 bg-[#1a1a1a] border-r border-gray-800 flex flex-col transform transition-transform duration-300 md:transform-none"
             :class="isNavOpen ? 'translate-x-0' : '-translate-x-full md:translate-x-0'">
            
            <div class="p-5 flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-purple-600 rounded-lg flex items-center justify-center shadow-lg shadow-purple-900/50">
                        <svg class="w-5 h-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"></path></svg>
                    </div>
                    <span class="text-lg font-bold tracking-tight">LegalWard</span>
                </div>
                <button @click="isNavOpen = false" class="md:hidden text-gray-400 hover:text-white">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>

            <nav class="flex-1 px-3 space-y-1 overflow-y-auto">
                <a href="#" class="flex items-center px-3 py-2.5 bg-gray-800 text-white rounded-lg group">
                    <svg class="w-5 h-5 mr-3 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"></path></svg>
                    <span class="font-medium text-sm">입법예고</span>
                </a>
                </nav>

            <div class="p-4 border-t border-gray-800">
                <div class="flex items-center">
                    <div class="w-8 h-8 rounded-full bg-gradient-to-tr from-purple-500 to-blue-500 flex items-center justify-center text-xs font-bold">U</div>
                    <div class="ml-3">
                        <p class="text-sm font-medium text-white">Pro User</p>
                    </div>
                </div>
            </div>
        </div>

        <div x-show="isNavOpen" @click="isNavOpen = false" class="fixed inset-0 bg-black/50 z-30 md:hidden backdrop-blur-sm" x-transition.opacity></div>


        <main class="flex-1 flex flex-col min-w-0 bg-[#121212] relative z-0">
            
            <div class="md:hidden h-14 flex items-center px-4 border-b border-gray-800 bg-[#121212] sticky top-0 z-20">
                <button @click="isNavOpen = true" class="text-gray-400 mr-4">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                </button>
                <span class="font-bold text-lg">입법예고</span>
            </div>

            <div class="p-4 border-b border-gray-800 bg-[#121212]">
                <div class="relative max-w-2xl mx-auto">
                    <input type="text" x-model="searchQuery" placeholder="법안 키워드 검색..." 
                           class="w-full bg-[#1e1e1e] border border-gray-700 text-gray-200 text-sm rounded-full focus:ring-2 focus:ring-purple-600 focus:border-transparent block pl-10 p-3 transition-shadow">
                    <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                        <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                    </div>
                </div>
                <div class="flex gap-2 mt-3 overflow-x-auto pb-1 no-scrollbar justify-center">
                    <select x-model="activeFilters.department" class="bg-[#1e1e1e] text-xs text-gray-400 rounded-lg border border-gray-700 py-1.5 px-3 focus:outline-none focus:border-purple-500">
                        <option value="all">모든 부처</option>
                        <template x-for="dep in filters.departments" :key="dep"><option :value="dep" x-text="dep"></option></template>
                    </select>
                    </div>
            </div>

            <div class="flex-1 overflow-y-auto p-4 space-y-3 scroll-smooth" id="feed-list">
                <template x-for="post in filteredPosts" :key="post.id">
                    <div @click="openDetail(post)" 
                         class="bg-[#1e1e1e] hover:bg-[#252525] rounded-xl p-4 cursor-pointer border border-transparent hover:border-purple-500/30 transition-all duration-200 active:scale-[0.99]">
                        <div class="flex items-start justify-between">
                            <div class="flex-1">
                                <div class="flex items-center gap-2 mb-1.5">
                                    <span class="text-[10px] font-bold px-1.5 py-0.5 rounded bg-gray-700 text-gray-300" x-text="post.department"></span>
                                    <span class="text-[10px] text-purple-400 font-medium" x-text="post.law_field"></span>
                                    <span class="text-[10px] text-gray-500">•</span>
                                    <span class="text-[10px] text-gray-500" x-text="getDDayString(post)"></span>
                                </div>
                                <h3 class="text-base font-bold text-gray-100 leading-snug mb-1" x-html="post.highlightedTitle || post.title"></h3>
                                <p class="text-xs text-gray-500 line-clamp-2">클릭하여 상세 내용과 규제영향분석서를 확인하세요.</p>
                            </div>
                            <div class="ml-3 flex flex-col items-center min-w-[40px]">
                                <div class="text-xs font-bold text-purple-400 mb-1">▲ <span x-text="post.upvotes"></span></div>
                            </div>
                        </div>
                    </div>
                </template>
                
                <div x-show="filteredPosts.length === 0" class="text-center py-20 text-gray-500">
                    <p>검색 결과가 없습니다.</p>
                </div>
            </div>
        </main>


        <div class="fixed inset-y-0 right-0 z-50 flex" 
             style="pointer-events: none;"> <div x-show="selectedPost" 
                 x-transition:enter="transform transition ease-out duration-300"
                 x-transition:enter-start="translate-x-full"
                 x-transition:enter-end="translate-x-0"
                 x-transition:leave="transform transition ease-in duration-200"
                 x-transition:leave-start="translate-x-0"
                 x-transition:leave-end="translate-x-full"
                 class="w-full md:w-[600px] lg:w-[800px] bg-[#1a1a1a] h-full shadow-2xl border-l border-gray-700 flex flex-col pointer-events-auto"
            >
                <div class="h-14 px-4 border-b border-gray-700 flex items-center justify-between bg-[#1a1a1a] shrink-0">
                    <button @click="closeDetail()" class="p-2 -ml-2 text-gray-400 hover:text-white rounded-full hover:bg-gray-800">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                    </button>
                    <div class="flex space-x-2">
                         <button class="text-xs bg-purple-600 text-white px-3 py-1.5 rounded-full font-bold">의견 등록</button>
                    </div>
                </div>

                <div class="flex-1 overflow-y-auto p-6 md:p-8 bg-[#121212]" x-data="{ tab: 'insight' }">
                    <div x-show="selectedPost">
                        <h2 class="text-xl md:text-2xl font-bold mb-4 leading-tight" x-text="selectedPost.title"></h2>
                        
                        <div class="flex border-b border-gray-700 mb-6">
                            <button @click="tab = 'insight'" :class="tab === 'insight' ? 'border-purple-500 text-purple-400' : 'border-transparent text-gray-500'" class="pb-2 px-4 text-sm font-medium border-b-2 transition-colors">요약</button>
                            <button @click="tab = 'original'" :class="tab === 'original' ? 'border-purple-500 text-purple-400' : 'border-transparent text-gray-500'" class="pb-2 px-4 text-sm font-medium border-b-2 transition-colors">원문</button>
                        </div>

                        <div x-show="tab === 'insight'" class="prose prose-invert prose-sm max-w-none">
                            <p class="text-gray-300 leading-relaxed">
                                이 법안은 <span x-text="selectedPost.department"></span>에서 발의했습니다. 
                                주요 내용은... (여기에 AI 요약이나 상세 데이터가 들어갑니다).
                            </p>
                            </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
        function app() {
            return {
                isNavOpen: false,
                searchQuery: '',
                selectedPost: null,
                activeFilters: { department: 'all' },
                
                // [중요] 데이터는 실제 환경에선 fetch로 가져와야 합니다.
                // 편의상 기존 데이터를 여기에 붙여넣으세요.
                allPosts: [
                    {"id": "1", "title": "예시: 노후계획도시 정비 및 지원에 관한 특별법", "department": "국토교통부", "law_field": "도시", "upvotes": 120, "end_date_ts": 1768834799000},
                    {"id": "2", "title": "예시: 건축법 시행령 일부개정령안", "department": "국토교통부", "law_field": "건축", "upvotes": 45, "end_date_ts": 1768834799000},
                    // ... (선생님의 기존 긴 데이터 배열을 여기에 넣으세요) ...
                ],
                
                filteredPosts: [],
                filters: {
                    departments: ["국토교통부", "환경부", "교육부", "기획재정부"] // 예시 데이터
                },
                fuse: null,

                initApp() {
                    // Fuse.js 검색 설정 (가볍게)
                    this.fuse = new Fuse(this.allPosts, {
                        keys: ['title', 'department'],
                        threshold: 0.4
                    });
                    this.filterPosts();
                    
                    // 필터나 검색어 변경 시 자동 실행
                    this.$watch('searchQuery', () => this.filterPosts());
                    this.$watch('activeFilters.department', () => this.filterPosts());
                },

                filterPosts() {
                    let result = this.allPosts;
                    
                    // 1. 부처 필터
                    if(this.activeFilters.department !== 'all') {
                        result = result.filter(p => p.department === this.activeFilters.department);
                    }

                    // 2. 검색어 필터
                    if(this.searchQuery.length > 0) {
                        result = this.fuse.search(this.searchQuery).map(r => {
                            // 하이라이팅 로직 단순화 (필요시 추가)
                            return { ...r.item, highlightedTitle: r.item.title.replace(this.searchQuery, `<span class="text-purple-400">${this.searchQuery}</span>`) };
                        });
                    }

                    this.filteredPosts = result;
                },

                openDetail(post) {
                    this.selectedPost = post;
                    // 모바일 주소창 색상 변경 등 UX 처리 가능
                },

                closeDetail() {
                    this.selectedPost = null;
                },

                // 날짜 계산 헬퍼
                getDDayString(post) {
                    // (간단 구현)
                    return "D-14"; 
                }
            }
        }
    </script>
</body>
</html>